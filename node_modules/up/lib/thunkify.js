export default (fn) => {
  return () => {
    var args = [].slice.call(arguments);
    var results;
    var called;
    var cb;

    args.push(() => {
      results = arguments;

      if (cb && !called) {
        called = true;
        cb(...results);
      }
    });

    fn(...args);

    return (fn) => {
      cb = fn;

      if (results && !called) {
        called = true;
        fn(...results);
      }
    }
  }
};
